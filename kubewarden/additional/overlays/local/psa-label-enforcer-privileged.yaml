apiVersion: policies.kubewarden.io/v1
kind: ClusterAdmissionPolicy
metadata:
  name: psa-label-enforcer-privileged
  namespace: ''
  annotations:
    artifacthub/pkg: psa-label-enforcer/psa-label-enforcer/0.1.2
spec:
  module: registry01.suse/rke-prod/ghcr.io/kubewarden/policies/psa-label-enforcer:v0.1.2
  rules:
    - apiGroups:
        - ''
      apiVersions:
        - v1
      resources:
        - namespaces
      operations:
        - CREATE
        - UPDATE
  mutating: true
  namespaceSelector:
     matchExpressions:
     - key: "kubernetes.io/metadata.name"
       operator: In
       values: [cattle-provisioning-capi-system, kube-system, cattle-monitoring-system, a, cattle-elemental-system, cattle-fleet-local-system, cattle-fleet-system, cattle-logging-system, cattle-monitoring-system, cattle-neuvector-system, cattle-resources-system, cattle-system, cattle-ui-plugin-system, cert-exporter, fleet-default, fleet-local, jaeger, kubewarden, nfs-subdir-external-provisioner, open-telemetry, xx]
  settings:
    description: null
    modes:
      enforce: privileged
      enforce-version: latest
      audit: restricted
      audit-version: latest
      warn: restricted
      warn-version: latest
    ignoreRancherNamespaces: false
  mode: protect
